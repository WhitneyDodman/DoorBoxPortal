<?xml version='1.0' encoding='UTF-8' ?> 
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:c="http://xmlns.jcp.org/jsp/jstl/core">
    <body>
        <ui:composition template="./WEB-INF/templates/accountView.xhtml">
            <ui:param name="title" value="DoorBox - Change Password"/>
            <ui:param name="metaDescription" value="Reset your account password"/>
            <ui:param name="metaKeywords" value="doorbox user and asset management portal"/>
            <ui:define name="accountPage">
                <h:form id="userRegForm">                        
                    <p:panel id="panel" class="three-quarters account-view--right" header="Update My Password">

                        <f:event listener="#{myPasswordBean.validatePassword}" type="postValidate" />
                        <p:messages id="messages" showSummary="true" showDetail="false" autoUpdate="true" closable="true" />
                                    
                        <p:panelGrid columns="2">

                            <h:outputLabel for="currentPassword" value="Current Password" style="font-weight:bold" />
                            <p:password id="currentPassword" value="#{myPasswordBean.currentPassword}" label="Current Password" required="true" >
                                <f:ajax render="currentPassword1Msg" event="keyup" />
                            </p:password>                            

                            <h:outputLabel for="newPassword1" value="New Password" style="font-weight:bold" />
                            <p:password id="newPassword1" value="#{myPasswordBean.newPassword1}" label="New Password" required="true" feedback="true" inline="true">
                                <f:ajax render="newPassword1Msg" event="keyup" />
                            </p:password>                            

                            <h:outputLabel for="newPassword2" value="Confirm Password" style="font-weight:bold" />
                            <p:password id="newPassword2" value="#{myPasswordBean.newPassword2}" label="Confirm Password" required="true" feedback="true" inline="true">
                                <f:ajax render="newPassword2Msg" event="keyup" />
                            </p:password>                            

                        </p:panelGrid>
                        <p:panelGrid columns="2">
                            <p:commandButton value="Update" id="updateButton" action="#{myPasswordBean.update}" validateClient="true" ajax="false" icon="ui-icon-check" />
                            <p:commandButton value="Cancel" action="myAccountOverview" immediate="true" icon="ui-icon-cancel"/>
                        </p:panelGrid>
                        
                    </p:panel>
                </h:form>
                <p:dialog widgetVar="messageDialog" id="msgDialog" modal="true" appendTo="@(body)" closeOnEscape="true" visible="false">
                    <p>Foo!</p>
                    <p:messages id="messagesInDialog" />
                    <p:button value="OK" onclick="messageDialog.hide()" />
                </p:dialog>
            </ui:define>
        </ui:composition>
    </body>
</html>